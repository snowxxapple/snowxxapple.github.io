<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>我的相册</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="" id='theme-link'>
    <link rel="stylesheet" type="text/css" href="" id='theme-link-ori'>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style type="text/css">
    .righticon {
        margin-top: 18px;
    }
    
    
    
    html {
        overflow-x: hidden;
    }
    
    .love {
        color: pink;
    }
    
    .lovenum {
        color: pink;
        margin-left: 5px;
    }
    
    .xpsize {
        height: 270px;
        /*width: 100%;*/
        
        overflow: hidden;
    }
    
    .sbj {
        padding-top: 30px;
    }
    
    .xclove {
        color: pink;
        margin-left: 5px;
    }
    
    .thumb {}
    
    .xclove2 {
        color: pink;
    }
    
    a {
        cursor: pointer;
    }
    
    html {
        overflow-y: hidden;
    }
    
    .kong {
        text-decoration: none!important;
    }
    
    
    </style>
</head>

<body>
    <nav class='navbar navbar-default navbar-fixed-top' role='navigation'>
        <div class="container">
            <div class='navbar-header' style='width:150px;'>
                <img src="img/1.jpg" class='img-circle navbar-brand' style='padding:0px'>
                <p style='margin-top:15px;'>小雪喜欢下雪天</p>
            </div>
            <ul class='nav navbar-nav pull-right'>
                <li><a href="xxblog.html">首页</a></li>
                <li><span class="glyphicon glyphicon-menu-right righticon"></span></li>
                <li><a href="xxblog.html#life1">爱生活</a></li>
                <li><span class="glyphicon glyphicon-menu-right righticon"></span></li>
                <li><a><strong>我的相册</strong></a></li>
            </ul>
        </div>
    </nav>
    <div class='box1'>
        <div class='container'>
            <div class="row" style='margin-top:50px;'>
                <div class="col-md-3 sbj" style='padding-left:0px;padding-right:0px;'>
                    <div class="col-md-10">
                        <ul class="list-group" style='text-align:center;'>
                            <li class='list-group-item'>
                                <h5><strong>相册列表</strong><span class='badge' style='background:#cce;margin-left:10px;'>6</span></h5>
                            </li>
                            <li class="list-group-item">
                                <span>
                            <a class='kong'>彩铅</a>
                        </span><span class='lovenum pull-right'>20</span>
                                <a class='zan'><span class='glyphicon glyphicon-heart love pull-right'></span></a>
                            </li>
                            <li class="list-group-item">
                                <span>
                            <a class='kong'>手工艺品</a>
                        </span>
                                <span class='lovenum pull-right'>20</span>
                                <a class='zan'><span class='glyphicon glyphicon-heart love pull-right'></span></a>
                            </li>
                            <li class="list-group-item">
                                <span>
                            <a class='kong'>校园歌手大赛</a>
                        </span>
                                <span class='lovenum pull-right'>20</span>
                                <a class='zan'><span class='glyphicon glyphicon-heart love pull-right'></span></a>
                            </li>
                            <li class="list-group-item">
                                <span>
                            <a  class='kong'>文艺生活</a>
                        </span>
                                <span class='lovenum pull-right'>20</span>
                                <a class='zan'><span class='glyphicon glyphicon-heart love pull-right'></span></a>
                            </li>
                            <li class="list-group-item">
                                <span>
                            <a  class='kong'>小雪的菜单</a>
                        </span>
                                <span class='lovenum pull-right'>20</span>
                                <a class='zan'><span class='glyphicon glyphicon-heart love pull-right'></span></a>
                            </li>
                            <li class="list-group-item">
                                <span>
                            <a  class='kong'>毕业纪念册</a>
                        </span>
                                <span class='lovenum pull-right'>20</span>
                                <a class='zan'><span class='glyphicon glyphicon-heart love pull-right'></span></a>
                            </li>
                            <li class='list-group-item' style='height:57px;'>
                                <ul class='pager' style='margin-top:2px;'>
                                    <li><a id='up' style='padding-right:10px;padding-left:10px;' class='pull-left'>上一页</a></li>
                                    <li><a id='down' style='padding-right:10px;padding-left:10px;' class='pull-right'>下一页</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-9 sbj">
                    <div class="row" style='margin-top:0px;'>
                        <div class='col-md-4'>
                            <div class="thumbnail thumb">
                                <div class='xpsize'>
                                    <a class='kong2'><img src="img/img1/x11.jpg" class='zpkong'></a>
                                </div>
                                <div class="caption">
                                    <span class='kong1'>彩铅</span>
                                    <span class='xclovenum pull-right xclove'>20</span><a class='xclove'><span class='glyphicon glyphicon-heart xclove pull-right'></span></a>
                                </div>
                            </div>
                        </div>
                        <div class='col-md-4'>
                            <div class="thumbnail thumb">
                                <div class='xpsize'>
                                    <a class='kong2'><img src="img/img2/1.jpg" class='zpkong'></a>
                                </div>
                                <div class="caption">
                                    <span class='kong1'>手工艺品</span><span class='xclovenum pull-right xclove'>20</span><a class='xclove'><span class='glyphicon glyphicon-heart xclove pull-right'></span></a>
                                </div>
                            </div>
                        </div>
                        <div class='col-md-4'>
                            <div class="thumbnail thumb">
                                <div class='xpsize'>
                                    <a class='kong2'><img src="img/img6/x61.jpg" class='zpkong'></a>
                                </div>
                                <div class="caption">
                                    <span class='kong1'>校园歌手大赛</span><span class='xclovenum pull-right xclove'>20</span><a class='xclove'><span class='glyphicon glyphicon-heart xclove pull-right'></span></a>
                                </div>
                            </div>
                        </div>
                        <div class='col-md-4'>
                            <div class="thumbnail thumb">
                                <div class='xpsize'>
                                    <a class='kong2'><img src="img/img4/1.jpg" class='zpkong'></a>
                                </div>
                                <div class="caption">
                                    <span class='kong1'>文艺生活</span><span class='xclovenum pull-right xclove'>20</span><a class='xclove'><span class='glyphicon glyphicon-heart xclove pull-right'></span></a>
                                </div>
                            </div>
                        </div>
                        <div class='col-md-4'>
                            <div class="thumbnail thumb">
                                <div class='xpsize'>
                                    <a class='kong2'><img src="img/img3/x31.jpg" class='zpkong'></a>
                                </div>
                                <div class="caption">
                                    <span class='kong1'>小雪的菜单</span><span class='xclovenum pull-right xclove'>20</span><a class='xclove'><span class='glyphicon glyphicon-heart xclove pull-right'></span></a>
                                </div>
                            </div>
                        </div>
                        <div class='col-md-4'>
                            <div class="thumbnail thumb">
                                <div class='xpsize'>
                                    <a class='kong2'><img src="img/img5/x51.jpg" class='zpkong'></a>
                                </div>
                                <div class="caption">
                                    <span class='kong1'>毕业纪念册</span><span class='xclovenum pull-right xclove'>20</span><a class='xclove'><span class='glyphicon glyphicon-heart xclove pull-right'></span></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/jquery-2.1.4.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script type="text/javascript">
window.onload = function() {
    var oIcon = document.getElementsByClassName('glyphicon glyphicon-heart love pull-right');
    var oIconx = document.getElementsByClassName('glyphicon glyphicon-heart xclove pull-right')
    var oNum = document.getElementsByClassName('lovenum pull-right');
    var oNumx = document.getElementsByClassName('xclovenum pull-right xclove');
    var oDown = document.getElementById('down');
    var oUp = document.getElementById('up');
    var oUl = document.getElementsByClassName('pager')[0];
    var oLi = oUl.getElementsByTagName('li');
    var arr = ['彩铅', '手工艺品', '校园歌手大赛', '文艺生活', '小雪的菜单', '毕业纪念册'];
    var arr1 = ['周末', '我和星星', '我', '彩铅3', '彩铅4', '彩铅5'];
    var flag = 1; //flag代表现在列表在第几页，1为第一页列表，2位第二页列表
    love(1);
    albumClick(1);

if(localStorage.getItem(30)==1)
 {
    $('#theme-link').attr('href', '');
    $('#theme-link-ori').attr('href','css/blog-ori.css');
 }
 if(localStorage.getItem(30)==2)
 {
     $('#theme-link').attr('href', 'css/blog.css');
     $('#theme-link-ori').attr('href','');
 }
    oDown.onclick = function() {
        love(2);
    }
    oUp.onclick = function() {
        love(1);
    }
    for (i = 0; i < 12; i++) //给localstorage的1到11号赋初值,如果localstorage里面没有值，那么都赋值为20，如果有，那么久读取当前存储的值
    {
        if (!localStorage.getItem(i)) {
            localStorage.setItem(i, 20);
        } else {
            localStorage.getItem(i);
        }
    }

    function love(flag) {
        var zanNumber;
        var zanxNumber; //根据flag的值来判断是第一页还是第二页，从而读取相应的localstorage的值
        for (i = 0; i < oIcon.length; i++) {
            oIcon[i].index = i;
            if (flag == 1) {
                oLi[0].className = 'disabled';
                oLi[1].className = 'active';
            }
            if (flag == 2) {
                oLi[1].className = 'disabled';
                oLi[0].className = 'active';
            }
            oIcon[i].onclick = function() {
                if (flag == 1) {
                    zanNumber = this.index;
                }
                if (flag == 2) {
                    zanNumber = this.index + 6;
                }
                oNum[this.index].innerHTML = parseInt(oNum[this.index].innerHTML) + 1;
                oNumx[this.index].innerHTML = parseInt(oNumx[this.index].innerHTML) + 1;

                saveLocalStorage(zanNumber, oNum[this.index].innerHTML); //用多个键值对来存储每个list的获得点赞数，0到5号存储第一页列表相册的点赞数
            }
        }
        for (m = 0; m < oIcon.length; m++) {
            oIconx[m].index = m; //这行报错了，没明白错在何处
            oIconx[m].onclick = function() {
                if (flag == 1) {
                    zanxNumber = this.index;
                }
                if (flag == 2) {
                    zanxNumber = this.index + 6;
                }
                oNumx[this.index].innerHTML = parseInt(oNumx[this.index].innerHTML) + 1;
                oNum[this.index].innerHTML = parseInt(oNum[this.index].innerHTML) + 1;
                saveLocalStorage(zanxNumber, oNumx[this].innerHTML); //用多个键值对来存储每个list的获得点赞数
            }
        }
        for (j = 0; j < oIcon.length; j++) { //读取键值对中的数值
            var oNumber;
            if (flag == 1) {
                oNumber = j;
            }
            if (flag == 2) {
                oNumber = j + 6;
            }
            oNum[j].innerHTML = localStorage.getItem(oNumber);
            oNumx[j].innerHTML = localStorage.getItem(oNumber);
        }
    }

    function saveLocalStorage(key, value) { //存储键值对，实际上直接用localstorage就行，这样写是为了体现localst的用法
        localStorage.setItem(key, value);
    }

    function albumClick(flag) {
        var oAlbumCol = document.getElementsByClassName('kong');
        var oAlbum = document.getElementsByClassName('kong1');

        for (y = 0; y < oAlbumCol.length; y++) {
            oAlbumCol[y].index = y + 1;
            oAlbumCol[y].onclick = function() { //列表中点击哪一个相册就异步刷新对应的相册内容
                var that = this;
                var albumNumber;
                if (flag == 1) {
                    albumNumber = this.index;
                }
                if (flag == 2) {
                    albumNumber = this.index + 6;
                }
                for (x = 0; x < oAlbumCol.length; x++) {
                    oAlbumCol[x].style.fontWeight = 400; //先把所有的相册名称字体变成默认值
                }
                this.style.fontWeight = 700; //点击的相册的字体加粗
                // if (flag == 1) {
                $.ajax({
                    url: 'album' + albumNumber + '.json',
                    type: 'GET',
                    dataType: 'json',

                })

                .done(function(img) { //获取照片成功，异步刷新成对应相册的页面
                    console.log("success", img.album);
                    $('.caption').remove();
                    $('.return-div').remove(); //移除的是div不是ul，只移除ul，div并不会移除，布局会有错
                    $('.page-div').remove();
                    for (k = 0; k < img.album.length; k++) {
                        $('.zpkong').eq(k).attr('src', img.album[k].img);
                    }
                    $('.col-md-4:last').after("<div class='col-md-4 return-div'><ul class='pager' style='margin-top:2px;'><li><a class='pull-left' id='return-list'>返回相册列表</a></li></ul></div><div class='col-md-4 page-div'><ul class='pager' style='margin-top:2px;'><li id='album-up'><a class='pull-left' id='album1-up'>上一页</a></li><li id='album-down'><a class='pull-right' id='album1-down'>下一页</a></li></ul></div>"); //添加上一页，下一页以及返回相册列表选项

                    $('#album1-down').click(function(event) { //当点击相册页面对应的下一页时，相册照片异步刷新

                        document.getElementById('album-down').className = 'disabled'; //仅仅是状态禁用，并没有移除onclik事件
                        document.getElementById('album-up').className = 'active';
                        $.ajax({
                                url: 'album' + albumNumber + '.json',
                                type: 'GET',
                                dataType: 'json',

                            })
                            .done(function(img) {
                                console.log("success", img.album);
                                for (p = 0; p < img.album.length - 6; p++) {
                                    $('.zpkong').eq(p).attr('src', img.album[p + 6].img);
                                }

                            })
                    });
                    $('#album1-up').click(function(event) { //当点击相册页面对应的上一页时，相册照片异步刷新
                        document.getElementById('album-up').className = 'disabled';
                        document.getElementById('album-down').className = 'active';
                        $.ajax({
                                url: 'album' + albumNumber + '.json',
                                type: 'GET',
                                dataType: 'json',

                            })
                            .done(function(img) {
                                console.log("success", img.album);
                                for (p = 0; p < img.album.length; p++) {
                                    $('.zpkong').eq(p).attr('src', img.album[p].img);
                                }
                            })
                    });
                    $('#return-list').click(function(event) { //点击返回相册列表按钮，异步刷新为相册列表的界面
                        /* Act on the event */
                        $.ajax({
                                url: 'albumlist.json',
                                type: 'GET',
                                dataType: 'json',
                            })
                            .done(function(img) { //一定要有传进来的参数，即为ajax从服务器获得的数据
                                console.log("success", img.albumlist);
                                for (q = 0; q < img.albumlist.length; q++) {
                                    $('.zpkong').eq(q).attr('src', img.albumlist[q].img);
                                }
                                $('.return-div').remove();
                                $('.page-div').remove();
                                for (n = 0; n < $('.xpsize').length; n++) {
                                    $('.xpsize').eq(n).after("<div class='caption'><span class='kong1'>" + arr[n] + "</span><span class='xclovenum pull-right xclove'>" + localStorage.getItem(n) + "</span><a class='xclove'><span class='glyphicon glyphicon-heart xclove pull-right'></span></a></div>")
                                }
                            })
                    });
                });
            }
        }
    }
    $('#down').click(function(event) {
        //点击相册列表的下一页按钮，就异步刷新列表内容，包括点赞数，同时刷新相册块的相册封面，并给相册块的每个相册块添加caption
        console.log("click")
        flag = 2;
        var oAlbumCol = document.getElementsByClassName('kong');
        $('.return-div').remove(); //移除的是div不是ul，只移除ul，div并不会移除，布局会有错
        $('.page-div').remove();
        $('.caption').remove();
        for (n = 0; n < $('.xpsize').length; n++) { //给每个相册封面下添加caption
            $('.xpsize').eq(n).after("<div class='caption'><span class='kong1'>" + arr1[n] + "</span><span class='xclovenum pull-right xclove'>" + localStorage.getItem(n + 6) + "</span><a class='xclove'><span class='glyphicon glyphicon-heart xclove pull-right'></span></a></div>")
        }
        for (x = 0; x < oAlbumCol.length; x++) {
            oAlbumCol[x].style.fontWeight = 400; //先把所有的相册名称字体变成默认值
        }
        $.ajax({
                url: 'data1.json',
                type: 'GET',
                dataType: 'json',

            })
            .done(function(img) {
                console.log("success");
                for (t = 0; t < $('.zpkong').length; t++) {
                    $('.zpkong').eq(t).attr('src', img.item[t].img); //异步更换相册封面
                    $('.kong').eq(t).html(img.item[t].title); //异步刷新相册列表
                    oNum[t].innerHTML = localStorage.getItem(t + 6); //异步刷新点赞数
                }
            })
        albumClick(2);
    });
    $('#up').click(function(event) { //点击相册列表的上一页按钮，就刷新当前页面
        flag = 1;
        albumClick(1);
        window.location.href = 'picture.html'; //直接刷新当前页面，刷到写死的那个页面
    });
}
</script>

</html>
